(()=>{"use strict";function t(e,i){let n,a=i;return"string"==typeof e[0]&&(e=[e]),e.forEach((e=>{if("string"==typeof e[0]&&(n=document.createElement(e[0]),a?a.appendChild(n):a=n),"object"==typeof e[1])for(let t in e[1])switch(t){case"class":let i=e[1].class;Array.isArray(e[1].class)&&(i=e[1].class.join(",")),n.classList.add(i);break;case"content":n.textContent=e[1].content;break;default:n.setAttribute(t,e[1][t])}Array.isArray(e[2])&&(1==e[2].length&&(e[2]=[e[2]]),t(e[2],n))})),a}function e(e,i=(()=>{})){let n=t(["div",{class:"modal",style:"position: fixed; \n               width: 100%; \n               height: 100%;\n               display: inline-flex;\n               background: transparent;\n               align-items: center;\n               justify-content: center;\n               top: 0;"},["div",{style:"background: white;\n              color: black;\n              padding: 1em;\n              box-shadow: 1px 1px 8px 2px rgba(0,0,0,0.3);\n              text-align: center;\n              max-width: 80%;\n              "},[["p",{content:e,style:"\n      padding-bottom: 1em;\n      "}],["button",{content:"Ok",style:"\n      background: #3498db;\n      color: white;\n      padding: 0.5em 2em;\n      border: NONE;\n      BORDER-RADIUS: 3PX;\n      text-align: center;\n      "}]]]]);document.getElementsByTagName("body")[0].appendChild(n),n.addEventListener("click",(t=>{t.preventDefault(),t.target.closest(".modal").remove(),i()}))}class i{constructor(t="Kanap"){this.localCartName=t,this.cartList=JSON.parse(localStorage.getItem(this.localCartName))||[]}search(t,e){return this.cartList.findIndex((i=>i.id==t&&i.color==e))}add(t,i,n){const a=this.search(t,n);return-1===a?(this.cartList.push({id:t,quantity:i,color:n}),localStorage.setItem(this.localCartName,JSON.stringify(this.cartList))):(this.cartList[a].quantity+=parseInt(i),localStorage.setItem(this.localCartName,JSON.stringify(this.cartList))),e("Produit ajouté au panier!"),this.cartList}remove(t,i){let n=this.search(t,i);if(-1!=n)return this.cartList.splice(n,1),localStorage.setItem(this.localCartName,JSON.stringify(this.cartList)),this.cartList;e("Le produit n'a été pas trouvé")}modify(t,i,n){let a=this.search(t,i);-1!=a?(this.cartList[a].quantity=n,localStorage.setItem(this.localCartName,JSON.stringify(this.cartList))):e("Erreur: L'objet à modifier n'existe plus")}reset(){localStorage.removeItem(this.localCartName),this.cartList=[]}getProdIdToOrder(){let t=[];return this.cartList.forEach((e=>{t.push(e.id)})),t}}class n{static container={image:document.querySelector(".item__img"),name:document.getElementById("title"),price:document.getElementById("price"),description:document.getElementById("description"),colors:document.getElementById("colors"),quantity:document.getElementById("quantity")};static item;static init(){const t=function(t){const e=new URL(window.location.href),i=new URLSearchParams(e.search);return!!i.has("id")&&(i.get("id")||"")}();t?this.load(t):e("Le produit n'a pas été spécifié. Veuillez choisir un produit",(()=>{window.location.href="./index.html"}))}static async load(t){try{this.item=await(async(t="")=>await fetch("http://localhost:3000/api/products/"+t).then((t=>{if(t.ok)return t.json().then((t=>{let e;return Array.isArray(t)?(e=[],t.forEach((t=>{e.push({_id:t._id,image:t.imageUrl,altTxt:t.altTxt,price:t.price,description:t.description,name:t.name,colors:t.colors})}))):e={_id:t._id,image:t.imageUrl,altTxt:t.altTxt,price:t.price,description:t.description,name:t.name,colors:t.colors},e}));throw new Error(t.status+": "+t.statusText)})))(t),this.container.image.innerHTML=`<img src="${this.item.image}" alt="${this.item.altTxt}">`,this.container.name.textContent=this.item.name,this.container.price.textContent=this.item.price,this.container.description.textContent=this.item.description,this.container.quantity.value=1,this.item.colors.forEach((t=>{this.container.colors.innerHTML+=`<option value="${t}">${t}</option>`})),document.getElementById("addToCart").addEventListener("click",(t=>{t.preventDefault(),this.submit()}))}catch(t){console.log(t),e("Desolé, un erreur est survenu. Veuillez réessayer ultérieurement",(()=>{window.location.href="./index.html"}))}}static submit(){const t=parseInt(this.container.quantity.value);t<1?e("La quantité à commander ne peut pas être inferieur a 1"):t>100?e("La quantité à commander ne peut pas être superieur a 100"):this.container.colors.value?(new i).add(this.item._id,t,this.container.colors.value):e("Vous devez choisir une couleur")}}window.onload=n.init()})();
//# sourceMappingURL=product.js.map